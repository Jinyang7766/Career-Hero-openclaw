# PRD 差距盘点（Wave6~Wave7 文档回填）

> 时间：2026-02-25（Wave6 + Wave7）
>
> 口径说明：本次为 **文档与交接/用户可用轨** 回填，仅更新 PRD 差距评估、发布门禁与 UX 验收文档，不包含代码实现变更。

---

## 完成比例变化（Wave5 → Wave6）

| PRD 模块 | Wave5 估算 | Wave6 估算 | 变化 | Wave6 主要增量 |
|---|---:|---:|---:|---|
| 4.1 简历管理与解析 | 67% | 70% | +3% | 补齐 Auth refresh 门禁口径与会话续期验收路径（文档层） |
| 4.2 JD 管理与岗位画像 | 28% | 30% | +2% | 增加知识检索发布门禁与交接约束，明确上线前检查口径 |
| 4.3 匹配分析与优化建议 | 76% | 79% | +3% | 增加 Wave6 E2E 门禁（降级/续期/失败回退）与验收证据要求 |
| 4.4 历史、可追溯与导出 | 82% | 86% | +4% | 强化 refresh 失败链路与历史可见性联动的回滚验收要求 |
| 4.5 质量保障、发布与运维 | 58% | 68% | +10% | 新增 release-readiness-report，补齐 checklist/runbook 的 Wave6 项 |

**整体完成度估算：** `62% → 67%（+5%）`

---

## Wave7 转轨回填（工程可用 -> 用户可用）

> 时间：2026-02-25（Wave7，文档回填）
>
> 口径说明：在 Wave6“门禁/交接可执行”基础上，新增用户体验可用性约束，确保从“工程能跑”转向“用户能理解、能完成、能恢复”。

### 转轨定义
- **工程可用（Wave6）**：接口契约明确、发布清单可执行、回滚路径存在。
- **用户可用（Wave7）**：核心页面信息层级清晰、文案可行动、技术字段默认隐藏、异常可恢复。

### Wave6 → Wave7 完成度（文档口径）

| PRD 模块 | Wave6 估算 | Wave7 估算 | 变化 | Wave7 主要增量 |
|---|---:|---:|---:|---|
| 4.1 简历管理与解析 | 70% | 73% | +3% | 增加输入/解析状态的用户可读提示与恢复动作规范 |
| 4.2 JD 管理与岗位画像 | 30% | 33% | +3% | 增加 JD 信息完整度提示与引导文案口径 |
| 4.3 匹配分析与优化建议 | 79% | 83% | +4% | 结果页信息分层（结论优先）与降级说明规范 |
| 4.4 历史、可追溯与导出 | 86% | 88% | +2% | 历史视图“可复用结论优先、技术追溯默认隐藏” |
| 4.5 质量保障、发布与运维 | 68% | 74% | +6% | 新增 UX 发布验收清单，纳入 release-readiness 门禁 |

**整体完成度估算：** `67% → 71%（+4%）`

### Wave7 新增产物（UX 向）
- `docs/user-facing-ux-guidelines.md`
- `docs/release-readiness-ux-checklist.md`

### 转轨后仍未收口缺口（进入 Wave8）
1. UX 规范尚未在前端界面完成全量实现与走查证据归档。
2. UX 验收尚未与 E2E 自动化形成稳定联动。
3. “用户可用”指标（完成率、重试率、误解率）尚未建立监控基线。

## 4.1 简历管理与解析（Phase A）

### 当前状态
- Resume CRUD、多版本、TXT 导入与解析状态链路已具备。
- analyze 支持 `resumeId/versionNo`。
- 历史链路可查询与导出。

### Wave6 回填增量
- 发布门禁中新增 Auth refresh 续期检查口径：
  - 会话过期后的刷新与重试路径
  - refresh 失败后的降级与提示路径
  - logout 后状态一致性验证

### 核心缺口
- PDF/DOCX 实际解析链路仍未落地。
- 异步解析任务、重试与告警仍缺实现。
- Auth refresh 仍以文档门禁为主，代码级闭环待落地。

### DoD（下一步）
- 上传解析闭环（PDF/DOCX）可用。
- 解析任务状态可观测（成功率/时延/失败原因）。
- 解析与历史链路可按 session/user 归属检索。

---

## 4.2 JD 管理与岗位画像（Phase B）

### 当前状态
- JD 仍以自由文本输入为主，实体化不足。
- 检索规格存在，但知识资产治理尚未成型。

### Wave6 回填增量
- 发布清单补齐知识检索上线前门禁：
  - 配置一致性核验（开关/索引版本/写入模式）
  - Wave6 E2E 场景纳管（检索命中与降级路径）

### 核心缺口
- JD CRUD 与版本表尚未在代码层完整实现。
- 知识库写入、索引构建与检索尚未接入运行链路。

### DoD（下一步）
- 至少 1 条端到端链路：保存 JD/知识文档 → 建索引 → analyze 复用。
- 检索命中结果可追溯到 `sourceType/sourceId/versionNo/chunkId`。

---

## 4.3 匹配分析与优化建议（Phase C）

### 当前状态
- analyze 已具备 `scoreBreakdown/insights/fallback/history`。
- Wave4/5 已完成 RAG + Knowledge 契约规格。

### Wave6 回填增量
- 在发布与交接轨中新增 E2E 门禁：
  - 会话有效 → analyze 成功
  - 会话过期 → refresh 成功后重试
  - refresh 失败 → 可降级/重建会话并保持主流程可恢复
  - 检索失败 → `degraded=true` 但主流程不中断

### 核心缺口
- 检索链路尚未工程化接入 analyze 主流程。
- 权重治理与建议质量量化标准仍缺实现。
- E2E 脚本尚未纳入 CI 且未形成稳定报告归档。

### DoD（下一步）
- analyze 输出稳定包含 `retrievalMeta`（命中/降级双路径一致）。
- 检索命中率、degraded 比例、端到端时延可观测。
- Wave6 E2E 场景进入 CI 并可追溯。

---

## 4.4 历史、可追溯与导出（Phase D）

### 当前状态
- 历史列表、详情、导出（TXT/JSON/PDF）已可用。
- Auth API/Session 规格已覆盖追溯字段建议。

### Wave6 回填增量
- 回滚手册补齐 refresh 故障的应急路径：
  - 续期失败后的模式回退建议（`hybrid/guest -> legacy`）
  - 历史可见性与会话状态一致性核验步骤
  - 回滚后验证清单新增 refresh 场景

### 核心缺口
- 历史记录尚未完整强关联 `resume_version + jd_version + session + evidence`。
- 缺少分析结果差异对比视图（分数/关键词/证据变化）。

### DoD（下一步）
- 历史详情可追溯到会话、版本与证据来源。
- 支持两次分析差异对比（结果 + 证据层）。
- refresh 失败与回退后的历史可见性有自动化验证。

---

## 4.5 质量保障、发布与运维（Phase E）

### 当前状态
- 已有基础回归与发布/回滚文档框架。
- Wave4/5 已覆盖 Auth/RAG/Knowledge 发布回退策略。

### Wave6 回填增量
- 新增 `docs/release-readiness-report.md`：
  - 汇总发布门禁（契约、配置、验证、监控、回滚）
  - 给出分级上线建议（文档发布可放行、功能发布需条件放行）
- 更新 `release-checklist`：
  - 增加 `/api/auth/session/refresh` 冒烟
  - 增加 Wave6 E2E 门禁（auth refresh + 主流程）
- 更新 `rollback-runbook`：
  - 增加 refresh 故障触发条件与临时止血策略
  - 增加回滚后 refresh 验证项

### 核心缺口
- Auth/KB/检索增强的最小 E2E 尚未稳定纳入 CI。
- 迁移、SLO 告警、预发演练证据仍待工程化落地。

### DoD（下一步）
- Wave6 E2E（refresh + degraded）进入 CI 基线。
- 发布后观测项覆盖 refresh 成功率/失败率与重试恢复率。
- 至少完成 1 次预发回滚演练并沉淀证据。

---

## Wave6 剩余差距清单（交接优先级）

| 优先级 | 差距项 | 当前状态 | Wave7 收口标准（DoD） | 交接Owner |
|---|---|---|---|---|
| P0 | Auth refresh 实装闭环 | 门禁定义完成，代码证据缺失 | 预发可跑通 `current -> refresh -> retry` 并归档日志 | Backend + Frontend |
| P0 | Wave6 E2E 自动化 | 场景定义完成，CI 未接入 | 4 条关键场景纳入 CI，失败可定位到 requestId/sessionId | QA + Backend |
| P1 | RAG/KB 降级观测 | 文档口径完成，监控未落地 | 发布后可观测 degraded 比例与刷新失败率 | SRE/值班 |
| P1 | 回滚演练证据化 | runbook 完整，演练记录缺失 | 至少 1 次预发演练，沉淀 RTO 与操作轨迹 | Release Owner |
| P2 | 历史差异可视化 | 需求明确，未实现 | 支持两次 analyze 结果+证据差异对比 | Product + FE |

### 进入 Wave7 的交接验收口径
- 交接包必须包含：发布清单勾选结果、E2E 报告、回滚演练记录、未收口风险列表。
- 值班同学可独立执行 checklist/runbook，并在 30 分钟内完成一次模拟放行判定。
- 所有“条件通过”门禁需明确责任人和 ETA（不得留空）。

## Wave6 结论

- Wave6 文档与交接轨核心价值：**把 Wave5 的“可对接契约”推进到 Wave6 的“可放行门禁 + 可执行交接”**。
- 本轮新增与升级文档：
  - 新增：`docs/release-readiness-report.md`
  - 更新：`docs/prd-gap-analysis.md`、`docs/prd-delivery-plan.md`
  - 更新：`docs/release-checklist.md`、`docs/rollback-runbook.md`
- 建议下一波（Wave7）优先顺序：
  1. Auth refresh 最小实现与前端续期联调
  2. KB/RAG 最小 E2E 脚本接入 CI
  3. 预发回滚演练证据与上线门禁自动化收口

---

## Wave7 补充结论（用户可用转轨）

- Wave7 文档回填核心价值：**把 Wave6 的“工程可用”补齐为“用户可用”标准**。
- 本轮新增文档：
  - `docs/user-facing-ux-guidelines.md`
  - `docs/release-readiness-ux-checklist.md`
- 本轮对 PRD 的新增约束：
  1. 信息层级必须满足“结论优先、解释其次、技术默认隐藏”
  2. 文案语气必须提供可执行动作（不是仅描述错误）
  3. 技术字段露出必须受控（显式展开/复制诊断）

### 建议下一波（Wave8）优先顺序
1. 前端按 UX 规范完成关键页面改造与截图证据归档
2. 将 UX 清单项与 E2E 场景绑定，形成自动化验收
3. 建立用户可用性指标：任务完成率、重试率、误解反馈率
